---
title: "ExploratoryAnalyses"
author: "MRB"
date: "October 27, 2017"
output:
  word_document: default
  pdf_document: default
  html_document: default
---

## Purpose
Document for data exploration for __Data Challenge 2017__!

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#read in neccessary packages

ipak <- function(pkg){
    new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
    if (length(new.pkg)) 
        install.packages(new.pkg, dependencies = TRUE)
    sapply(pkg, require, character.only = TRUE)
}

packages <- c("GGally", "tidyverse", "caret", "glmnet", "arsenal")

ipak(packages)

#read in dataset

dc <- read_csv("Data.csv")

##EVALUATE THE STRUCTURE OF THE DATA

dim(dc)
names(dc)
str(dc)

# variable x1 operates the same as ID. Will keep ID.

dc1 <- dc %>% 
  dplyr::select(-X1)
```

# Look at the data

```{r tab1, include = TRUE, echo=FALSE, results='asis'}

## CREATE A SUMMARY TABLE
#change the treatment from integer to character so the desired information is expressed in the summary table

class(dc1$A) <- "character"

tab1 <- dc1 %>% 
  dplyr::select(-ID) %>% 
  tableby(formula = ~ .)

summary(tab1, title = "Overall Data Summary")
```


```{r spm1, include = TRUE, fig.align="center", cache=TRUE, echo=FALSE}

## CREATE A SCATTERPLOT MATRIX

# ID has no bearing on the modeling. will exclude from evaluation.

sp1 <- dc1 %>% 
  dplyr::select(-ID) %>% 
  ggpairs()

# sp1
# ggsave("sp1.tiff", device = "tiff", plot = last_plot(), width = 15, height = 15, unit = "in")
# unlink("sp1.tiff")
```

![knit to html to see](sp1.tiff)

```{r, model1, include=TRUE, echo=FALSE, results='asis'}

mod1 <- modelsum(data = dc1, formula = formulize("Y", names(dc1)[4:28]), adjust = ~ A, family = "gaussian")
summary(mod1, title = "Model Summaries: Y = W_i + A, for i = 1, 2, ..., 25")
```

